# Microgrid-energy-optimization
Energy cost optimization in microgrids using MILP and Two-Stage Stochastic Optimization
# Microgrid Energy Cost Optimization

Βελτιστοποίηση κόστους ενέργειας σε μικροδίκτυο με χρήση ντετερμινιστικής (MILP) και στοχαστικής βελτιστοποίησης (Two-Stage Stochastic Optimization).

## Περιγραφή

Αυτό το project αναπτύχθηκε στο πλαίσιο της διπλωματικής μου εργασίας στη Σχολή Εφαρμοσμένων Μαθηματικών και Φυσικών Επιστημών (ΣΕΜΦΕ) του Εθνικού Μετσόβιου Πολυτεχνείου (ΕΜΠ).

Επικεντρώνεται στη **βελτιστοποίηση του λειτουργικού κόστους** ενός μικροδικτύου που αποτελείται από:

- **Φωτοβολταϊκά (PV)**: Παραγωγή ανανεώσιμης ενέργειας
- **Σύστημα Αποθήκευσης (Μπαταρία)**: Αποθήκευση πλεονάζουσας ενέργειας
- **Δίκτυο**: Αγορά και πώληση ενέργειας
- **Φορτίο**: Κατανάλωση ενέργειας

### Πρόβλημα

Το κύριο πρόβλημα είναι η **ελαχιστοποίηση του κόστους** λειτουργίας του μικροδικτύου, λαμβάνοντας υπόψη την αβεβαιότητα στην παραγωγή PV, τη ζήτηση φορτίου και τις τιμές ενέργειας.

### Προσέγγιση

Το project υλοποιεί και συγκρίνει **δύο μεθοδολογίες**:

#### 1. Ντετερμινιστική Βελτιστοποίηση (MILP)
- Χρησιμοποιεί Mixed-Integer Linear Programming
- Βασίζεται σε γνωστά/προβλεπόμενα δεδομένα
- Παρέχει βέλτιστες αποφάσεις χωρίς αβεβαιότητα

#### 2. Στοχαστική Βελτιστοποίηση (Two-Stage SO)
- Υλοποιεί Two-Stage Stochastic Optimization
- Λαμβάνει υπόψη την αβεβαιότητα μέσω σεναρίων
- Τα σενάρια δημιουργούνται με **Monte Carlo simulation**
- Χρησιμοποιεί στατιστικές κατανομές:
  - **Beta distribution** για παραγωγή PV
  - **Lognormal distribution** για κατανάλωση
  - **Normal distribution** για τιμές ενέργειας

## Δομή Project
```
├── src/
│   ├── EnergyMILPmodel.py           # Ντετερμινιστικό μοντέλο MILP
│   ├── kainourio-monte-carlo.py     # Δημιουργία σεναρίων Monte Carlo
│   └── two-stage-so-kainourio.py    # Two-stage στοχαστική βελτιστοποίηση
├── README.md
└── requirements.txt
```


## Χαρακτηριστικά

✅ Δύο μεθοδολογίες βελτιστοποίησης (MILP και Two-Stage SO)  
✅ Monte Carlo Simulation για δημιουργία ρεαλιστικών σεναρίων  
✅ Πλήρης μοντελοποίηση μικροδικτύου με όλα τα στοιχεία  
✅ Συγκριτική ανάλυση με visualizations  
✅ Πραγματικά δεδομένα κατανάλωσης/παραγωγής  
✅ Open-source και πλήρως τεκμηριωμένος κώδικας

## Απαιτήσεις

- Python 3.8+
- PySCIPOpt
- pandas
- numpy
- scipy
- matplotlib
- openpyxl

## Εγκατάσταση
````markdown
```
pip install -r requirements.txt
```
```

### Εγκατάσταση SCIP Solver

Το PySCIPOpt χρειάζεται τον SCIP solver. Εγκατάστησε τον από:
https://www.scipopt.org/

## Χρήση

### 1. Δημιουργία Σεναρίων Monte Carlo
````markdown
```
python src/kainourio-monte-carlo.py
```

Αυτό δημιουργεί σενάρια για 365 ημέρες με 10 σενάρια ανά ημέρα, περιλαμβάνοντας:
- Παραγωγή PV (με μηδενική νυχτερινή παραγωγή)
- Κατανάλωση φορτίου
- Τιμές αγοράς/πώλησης ενέργειας

**Έξοδος:** `monte_carlo_scenarios_CORRECTED.xlsx`

### 2. Εκτέλεση Ντετερμινιστικού Μοντέλου
```
python src/EnergyMILPmodel.py
```

Το μοντέλο επιλύει το πρόβλημα βελτιστοποίησης για κάθε ημέρα ξεχωριστά και παράγει:
- Βέλτιστες ροές ενέργειας
- Κατάσταση φόρτισης μπαταρίας (SOC)
- Ημερήσιο και μηνιαίο κόστος
- Γραφήματα ροών ενέργειας

**Έξοδος:** `all_days_flows_soc.xlsx` + visualizations

### 3. Εκτέλεση Στοχαστικού Μοντέλου
```
python src/two-stage-so-kainourio.py
```

Υλοποιεί two-stage stochastic optimization:
- **First Stage**: Αποφάσεις πριν την αβεβαιότητα
- **Second Stage**: Διορθωτικές ενέργειες για κάθε σενάριο

**Έξοδος:** `stochastic_optimization_results.xlsx`

## Παράμετροι Συστήματος

| Παράμετρος | Τιμή | Μονάδα |
|------------|------|--------|
| Χωρητικότητα μπαταρίας | 5 | kWh |
| Μέγιστη ισχύς PV | 3.5 | kW |
| Απόδοση φόρτισης | 98 | % |
| Απόδοση εκφόρτισης | 95 | % |
| Χρονικό βήμα | 15 | λεπτά |
| Βήματα/ημέρα | 96 | - |
| Αρχικό SOC | 50 | % |

## Μαθηματική Διατύπωση

### Αντικειμενική Συνάρτηση

**MILP (Ντετερμινιστικό):**
```math
\min \sum_{t} [P_{g,import}(t) \cdot BuyPrice(t) - P_{g,export}(t) \cdot SellPrice(t)] \cdot \Delta t
```

**Two-Stage SO (Στοχαστικό):**
```math
\min \sum_{t} [Cost_{stage1}(t)] + \sum_{s} [Prob(s) \cdot Cost_{stage2}(t,s)]
```

### Περιορισμοί

- Ισοζύγιο ενέργειας
- Όρια φόρτισης/εκφόρτισης μπαταρίας
- Μη ταυτόχρονη φόρτιση/εκφόρτιση
- Όρια SOC (State of Charge)
- Όρια παραγωγής PV

## Αποτελέσματα

Το project παρέχει συγκριτική ανάλυση που περιλαμβάνει:

- **Κόστη**: Ημερήσια, μηνιαία και ετήσια κόστη για κάθε μέθοδο
- **Ροές Ενέργειας**: Αναλυτικές ροές από/προς κάθε στοιχείο
- **SOC**: Εξέλιξη κατάστασης φόρτισης μπαταρίας
- **Visualizations**: Γραφήματα σύγκρισης των δύο μεθόδων

## Τεχνολογίες

- **Γλώσσα**: Python 3.8+
- **Solver**: SCIP (PySCIPOpt)
- **Optimization**: Mixed-Integer Linear Programming, Stochastic Optimization
- **Data Analysis**: pandas, numpy
- **Visualization**: matplotlib
- **Statistical Methods**: scipy (Beta, Lognormal, Normal distributions)

## Motivation

Με την αυξανόμενη διείσδυση των ανανεώσιμων πηγών ενέργειας και των συστημάτων αποθήκευσης, η αποδοτική διαχείριση των μικροδικτύων γίνεται ολοένα και πιο κρίσιμη. Οι παραδοσιακές ντετερμινιστικές μέθοδοι δεν μπορούν πάντα να διαχειριστούν αποτελεσματικά την εγγενή αβεβαιότητα της παραγωγής PV και της κατανάλωσης.

Αυτό το project διερευνά πώς η στοχαστική βελτιστοποίηση μπορεί να οδηγήσει σε πιο ανθεκτικές και οικονομικά αποδοτικές λύσεις.

## Μελλοντικές Βελτιώσεις

- [ ] Προσθήκη περισσότερων σεναρίων
- [ ] Υλοποίηση rolling horizon optimization
- [ ] Ενσωμάτωση πρόβλεψης καιρού
- [ ] Επέκταση σε multi-day optimization
- [ ] Graphical User Interface (GUI)

## Συγγραφέας

**[Ευαγγελία Λαζόγλου]**  
Διπλωματική Εργασία  
Σχολή Εφαρμοσμένων Μαθηματικών και Φυσικών Επιστημών (ΣΕΜΦΕ)  
Εθνικό Μετσόβιο Πολυτεχνείο  

## License

MIT License


